# 二 寄存器

**概述**

CPU

* 一个典型的CPU是由运算器，控制器，寄存器等器件组成的，这些器件靠内部总线相连
* 内部总线实现CPU内部的哥哥器件之间的联系
* 外部总线实现CPU和主板上其他期间的联系

寄存器名称

* AX
* BX
* CX
* DX
* SI
* DI
* SP
* BP
* IP
* CS
* SS
* DS
* ES
* PSW



> 2.1 通用寄存器

* 8806CPU所有的寄存器都是16位的，可以存放两个字节
* AX,BX,CX,DX通常用来存放一般性数据的被统称为为通用寄存器

1. 以AX为例

   * 一个16位的寄存器可以存储一个16位的数据
   * 一个16位的寄存器可以储存的数据为2^16-1(减一是因为从0开始)
   * 一个16位寄存器可分为AL(8位低位)寄存器和AH(8位高位)寄存器，AL和AH都是可以独立使用的

   ![image-20200926113152228](C:\Users\Z-X-L\AppData\Roaming\Typora\typora-user-images\image-20200926113152228.png)

> 2.2 字在寄存器中的储存

* 一个字可以存放到一个16位寄存器中，这个字的高位字节和低位字节自然就存在这个寄存器的高8位寄存器和底8位寄存器

> 2.3 简单基础的汇编指令

`MOV AX,18` 将18送入AX寄存器

`ADD AS,8`    将AX中的值数据加上8后再放入AX中

编程2的4次方

```Assembly Language
MOV AX,2
MOV BX,2
ADD AX,BX
ADD AX,BX
ADD AX,BX
ADD AX,BX
```

> 2.4 物理地址

* CPU访问内存单元时要给出内存单元的地址，所有的内存单元构成的存储空间是一个一维的线性空间
* 我们将这个地址叫做物理地址

> 2.5 16位结构的CPU

* 计算器一次最多处理16位的数据
* 寄存器的最大宽度为16位
* 寄存器和运算去之间的通路是16位的

> 2.6 8086CPU的物理地址的方法

* 8086有20位地址总线，可传达20位地址，寻址能力为1M
* 8086内部为16位结构，他只能传送16位的地址，表现出的寻址能力却只有64K

> 2.7 段地址X16 + 偏移地址 = 物理地址的本质含义

* 基础地质+偏移地址=物理地址
* 段地址X16 + 偏移地址 = 物理地址

> 2.8 段的概念

* 内存并没有分段，段的划分是来自CPU，由于8086CPU用“段地址 X 16 + 偏移地址 = 物理地址”的方式给出内存单元的物理地址，使得我们可以用分段的方式来管理内存，在编程时可以根据需要，将若干地中海连续的内存单元看做一个段，用段地址X16定位段的起始地址（基础地址），用偏移地址定位段中的内存单元
  1. 段地址是16的倍数，一个短的起始地址也是16的倍数
  2. 偏移地址为16位，16位地址的寻址能力为64K，所以一个段的长度最大为64K
  3. CPU可以用不同的段地址和偏移地址形成指向同一个物理地址

![image-20200926151810534](C:\Users\Z-X-L\AppData\Roaming\Typora\typora-user-images\image-20200926151810534.png)

* 表示

  1. 21F60H内存单元在8086的两种描述

     （a）数据在内存2000::1F60单元中

     （b）数据存在内存的2000段中的1F60HH单元中

     

> 2.9 段寄存器

* 段寄存器就是提供地址的
  * CS
  * DS
  * SS
  * ES
* 当16位CPU要访问内存是，由这4个寄存器提供内存单元的段地址

> 2.10 CS和IP

* CS和IP是8086CPU中最关键的寄存器，它们指示了CPU当前要读取的指令的地址
  1. CS 为代码段寄存器
  2. IP 为指令指针寄存器（偏移量寄存器）

* 工作流程
  1. 从CS:IP指向内存单元读取指令，读取的指令进入指令缓冲器
  2. IP = IP + 所读取指令的长度，从而指向下一条指令
  3. 执行指令，转到 步骤1重复这个过程

* 8086PC工作过程
  1. 在8086开始工作时，CS和IP被设置为CS=FFFFHH,IP=0000H
  2. 即在8086刚启动时，CPU从内存FFFF0H单元中读取指令执行
  3. FFFF0H单元中的指令是8086PC开机后执行的第一条指令
* 在任何时候，CPU将CS,IP中的内容当做指令的段地址和偏移地址，用它们合成指令的物理地址，到内存中读取指令码，执行。若果说内存中一段信息被CPU执行过的话，那么它所在的内存单元必然被CS:IP指向过

> 2.11 修改CS:IP的指令

在CPU中，程序猿能够用指令读写的部件只有寄存器，程序员可以通过改变寄存器中的内容实现对CPU的控制

CPU从何处执行命令式由CS：IP中的内容决定的，程序员可以通过改变CS:IP中的内容来控制CPU执行的目标和指令

* `JMP 段地址:偏移地址` 指向到新的地址
* `JMP 通用寄存器` 仅修改偏移地址

> 2.12 代码段

对于8086PC机，在编程时，可以根据需要将一组内存单元定义为一个段。

可以将长度N的一组代码存在一组地址连续，起始地址为16的倍数的内存单元中，这段内存是用来存放代码的，从而定义了一个代码段

![image-20200926164740714](C:\Users\Z-X-L\AppData\Roaming\Typora\typora-user-images\image-20200926164740714.png)



> 试验一 

